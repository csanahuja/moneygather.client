<!DOCTYPE html>
<html>
<head>
    <title>Monopoly Game!</title>

    <link rel="stylesheet" 
        href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css"
        integrity="sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T"
        crossorigin="anonymous">

</head>

<body>

    <header class="bg-primary py-4">
        <div class="container">
            <h1>Welcome to Monopoly!</h1>
        </div>
    </header>

    <main class="container py-4">
        <p class="status"></p>
        <p> Click the button to update your credits </p>
        <p> Current credits: <span class="credits">0</span>â‚¬</p>
        <button class="update-credit">UPDATE CREDIT</button>
        <button class="clear-credit">CLEAR CREDIT</button>
        <button class="add-player">ADD PLAYER</button>
        <input class="text-message" type="text">
        <button class="send-text">SEND MESSAGE</button>
    </main>

    <footer class="bg-dark text-white py-5">
        <div class="container">
            On development
        </div>
    </footer>

    <script
        src="https://code.jquery.com/jquery-3.4.1.slim.min.js"
        integrity="sha256-pasqAKBDmFT4eHoN2ndd6lN370kFiGUFyTiUHWhU7k8="
        crossorigin="anonymous"></script>
    <script>
        $(function(){

            let socket = new WebSocket("wss://api.niticras.com/ws");

            socket.onopen = function(e) {
                console.log("[open] Connection established");
            };

            socket.onmessage = function(event) {
                $('.status').text(event.data);
            };

            socket.onclose = function(event) {
                if (event.wasClean) {
                    console.log(`[close] Connection closed cleanly, code=${event.code} reason=${event.reason}`);
                } else {
                    console.log('[close] Connection died');
                }
            };

            socket.onerror = function(error) {
                console.log(`[error] ${error.message}`);
            };

            $('.update-credit').on('click', function(){
                socket.send("UPDATE_CREDIT");
            })

            $('.clear-credit').on('click', function(){
                socket.send("CLEAR_CREDIT");
            })

            $('.send-text').on('click', function(){
                socket.send("MSG - " + $('.text-message').val());
            })

            $('.add-player').on('click', function(){
                socket.send("ADD_PLAYER|"+ JSON.stringify({name:'hola', colour:'#00000'}))
            })

        });

    </script>
</body>
</html>