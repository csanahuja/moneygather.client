<!DOCTYPE html>
<html>
<head>
    <title>Monopoly Websockets</title>
</head>

<body>
    <h1>Monopoly Websockets</h1>
    <p> Click the button to update your credits </p>
    <p> Current credits: <span class="credits">0</span>â‚¬</p>
    <button class="update-credit">UPDATE CREDIT</button>
    <button class="clear-credit">CLEAR CREDIT</button>

    <script
        src="https://code.jquery.com/jquery-3.4.1.slim.min.js"
        integrity="sha256-pasqAKBDmFT4eHoN2ndd6lN370kFiGUFyTiUHWhU7k8="
        crossorigin="anonymous"></script>
    <script>
        $(function(){

            let socket = new WebSocket("wss://207.180.254.152:9000");

            socket.onopen = function(e) {
                console.log("[open] Connection established");
            };

            socket.onmessage = function(event) {
                $('.credits').text(event.data);
            };

            socket.onclose = function(event) {
                if (event.wasClean) {
                    console.log(`[close] Connection closed cleanly, code=${event.code} reason=${event.reason}`);
                } else {
                    console.log('[close] Connection died');
                }
            };

            socket.onerror = function(error) {
                console.log(`[error] ${error.message}`);
            };

            $('.update-credit').on('click', function(){
                socket.send("UPDATE_CREDIT");
            })

            $('.clear-credit').on('click', function(){
                socket.send("CLEAR_CREDIT");
            })

        });

    </script>
</body>
</html>